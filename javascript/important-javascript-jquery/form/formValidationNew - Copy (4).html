<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email & Mobile Validation</title>
    <style type="text/css">
        * { padding: 0; margin: 0; box-sizing: border-box; }
        .form { max-width: 400px; width: 100%; display: flex; flex-direction: column; margin-inline: auto; background: #eee; padding: 24px; border: 1px solid #ccc; }
        .form .textInput { width: 100%; display: flex; flex-direction: column; row-gap: 8px; }
        .form .textInput:not(:last-child) { margin-bottom: 16px; }
        .form .textInput .form-control, .form .btn { height: 38px; padding-inline: 8px; }
        .form .textInput .error { color: red; font-size: 12px; }
        .form .success { color: green; font-size: 14px; display: none; margin-top: 16px; text-align: center; }
        .btn.valid-submit { background-color: green; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <form id="form" class="form">
        <div class="textInput">
            <label for="firstName">First Name:</label>
            <input id="firstName" class="form-control" type="text" placeholder="First Name">
            <span class="error"></span>
        </div>

        <div class="textInput">
            <label for="lastName">Last Name:</label>
            <input id="lastName" class="form-control" type="text" placeholder="Last Name">
            <span class="error"></span>
        </div>
        
        <div class="textInput">
            <label for="dob">Date of Birth:</label>
            <input id="dob" class="form-control" type="date">
            <span class="error"></span>
        </div>
        
        <div class="textInput">
            <label for="country">Country:</label>
            <select id="country" class="form-control">
                <option value="">Select Country</option>
                <option value="USA">United States</option>
                <option value="UK">United Kingdom</option>
                <option value="India">India</option>
                <option value="Canada">Canada</option>
                <option value="Australia">Australia</option>
            </select>
            <span class="error"></span>
        </div>
        
        <div class="textInput">
            <label for="email">Email:</label>
            <input id="email" class="form-control" type="text" placeholder="Email address">
            <span class="error"></span>
        </div>
        
        <div class="textInput">
            <label for="mobile">Mobile:</label>
            <input id="mobile" class="form-control" type="text" placeholder="Mobile number">
            <span class="error"></span>
        </div>
        
        <button type="button" id="submitBtn" onclick="validateAndSubmit()" class="btn">Submit</button>

        <span class="success">Your form has been successfully submitted.</span>
    </form>
      
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".form-control").forEach(field => {
                field.addEventListener("input", validateAndSubmit);
                field.addEventListener("change", validateAndSubmit);
            });

            populateFormFromLocalStorage();
            validateAndSubmit(); // Ensure button state is correct on page load
        });

        function validateAndSubmit() {
            let isValid = true;

            function showError(fieldId, message) {
                document.getElementById(fieldId).nextElementSibling.textContent = message;
                if (message) isValid = false;
            }

            const firstName = document.getElementById("firstName").value.trim();
            const lastName = document.getElementById("lastName").value.trim();
            const dob = document.getElementById("dob").value;
            const country = document.getElementById("country").value;
            const email = document.getElementById("email").value.trim();
            const mobile = document.getElementById("mobile").value.trim();
            const submitBtn = document.getElementById("submitBtn");

            // Name validation
            const namePattern = /^[A-Za-z]{2,}$/;
            showError("firstName", firstName.match(namePattern) ? "" : "Only alphabets allowed (min 2 characters).");
            showError("lastName", lastName.match(namePattern) ? "" : "Only alphabets allowed (min 2 characters).");

            // DOB validation
            const today = new Date();
            showError("dob", dob && new Date(dob) < today ? "" : "Enter a valid Date of Birth.");

            // Country validation
            showError("country", country ? "" : "Please select a country.");

            // Email validation
            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,63}$/;
            showError("email", email.match(emailPattern) ? "" : "Enter a valid email address.");

            // Mobile validation
            const mobilePattern = /^[0-9]{10,15}$/;
            showError("mobile", mobile.match(mobilePattern) ? "" : "Enter a valid mobile number (10-15 digits).");

            // Enable/disable button
            if (isValid) {
                submitBtn.classList.add("valid-submit");
                saveToLocalStorage({ firstName, lastName, dob, country, email, mobile });
            } else {
                submitBtn.classList.remove("valid-submit");
            }
        }

        function saveToLocalStorage(data) {
            localStorage.setItem("formData", JSON.stringify(data));
        }

        function populateFormFromLocalStorage() {
            const savedData = localStorage.getItem("formData");
            if (savedData) {
                const formData = JSON.parse(savedData);
                document.getElementById("firstName").value = formData.firstName || "";
                document.getElementById("lastName").value = formData.lastName || "";
                document.getElementById("dob").value = formData.dob || "";
                document.getElementById("country").value = formData.country || "";
                document.getElementById("email").value = formData.email || "";
                document.getElementById("mobile").value = formData.mobile || "";
            }
        }
    </script>
</body>
</html>
